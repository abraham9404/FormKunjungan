<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous" />
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" />

    <!-- My CSS -->
    <link rel="stylesheet" href="style.css" />

    <title>Form Kunjungan Marketing</title>
  </head>
  <body>
    <div id="logo">
      <div id="logoroyal"><img src="img/Logoratk.png" alt="logo_royal" /></div>
    </div>

    <h1 id="title"><strong>Form Kunjungan Marketing</strong></h1>
    <div class="alert alert-success alert-dismissible fade show d-none my-alert" role="alert">
      Data Kustomer sudah diterima <strong>Semangat!!</strong>
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
    <form name="Form-Kunjungan-Marketing">
      <label for="name" id="name-label">
        Nama
        <input type="text" id="name" placeholder="Masukkan Nama Kustomer" name="nama" required />
      </label>

      <label for="email" id="email-label">
        Email
        <input type="email" id="email" placeholder="Email kustomer" name="email" />
      </label>

      <label for="number" id="number-label">
        Nomor Telepon
        <input type="number" id="number" name="nomor-telepon" />
      </label>

      <label for="nama-instansi" id="nama-instansi-label">
        Nama Instansi
        <input type="text" id="nama-instansi" name="nama-instansi" />
      </label>

      <label for="alamat" id="alamat-label">
        Alamat
        <input type="text" id="alamat" name="alamat" />
      </label>

      <label for="dropdown" id="dropdown-label">
        Keterangan
        <select id="dropdown" name="keterangan">
          <option value="Penawaran">Penawaran</option>
          <option value="Follow Up">Follow Up</option>
          <option value="Repeat Order">Repeat Order</option>
          <option value="Pengadaan">Pengadaan</option>
          <option value="Learning">Learning</option>
        </select>
      </label>

      <label for="dropdown" id="dropdown-label">
        Marketing
        <select id="dropdown" name="marketing">
          <option value="Angger">Angger</option>
          <option value="Luky">Luky</option>
          <option value="Rizal">Rizal</option>
          <option value="Bagus">Bagus</option>
          <option value="Steven">Steven</option>
        </select>
      </label>

      <label for="comments" id="comments-label">
        Keterangan Lain
        <textarea id="comment" cols="30" rows="10" name="keterangan-lain"></textarea>
      </label>

      <button id="submit" type="submit" class="btn btn-primary btn-kirim" name="Form-Kunjungan-Marketing">SUBMIT</button>
      <button class="btn btn-primary btn-loading d-none" type="button" disabled>
        <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
        Loading...
      </button>
    </form>

    <script>
      const scriptURL = "https://script.google.com/macros/s/AKfycbynsD7skoQjv_WyrGgoz1iauycLfeBo6DjmpOGm6Dapx76Y51qMexl8AVEN9SJHeO0v/exec";
      const form = document.forms["Form-Kunjungan-Marketing"];
      const btnKirim = document.querySelector(".btn-kirim");
      const btnLoading = document.querySelector(".btn-loading");
      const myAlert = document.querySelector(".my-alert");

      form.addEventListener("submit", (e) => {
        e.preventDefault();
        //ketika tombol submit diklik
        //tampilkan tombol loading, hilangkan tombol kirim
        btnLoading.classList.toggle("d-none");
        btnKirim.classList.toggle("d-none");
        fetch(scriptURL, { method: "POST", body: new FormData(form) })
          .then((response) => {
            //tampilkan tombol kirim, hilangkan tombol loading
            btnLoading.classList.toggle("d-none");
            btnKirim.classList.toggle("d-none");
            //tampilkan tombol kirim, hilangkan tombol loading
            myAlert.classList.toggle("d-none");
            //reset form
            form.reset();
            var elmnt = document.getElementById("logo");
            elmnt.scrollIntoView();
            console.log("Success!", response);
          })
          .catch((error) => console.error("Error!", error.message));
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script>
  </body>
</html>
